<!--１つの投稿のshowページ-->
<!--投稿成功メッセージ-->
<p class="text-success"><%= flash[:notice_create] %></p>
<!--投稿更新メッセージ-->
<p class="text-success"><%= flash[:notice_update] %></p>


<div class="container">
  <div class="row mx-auto">
    
    <!--部分テンプレート-->
    <div class ="col-md-3">
      <%= render "books/profile_new",user:@user, newbook:@newbook %>
    </div>
    
    <div class="col-md-8 offset-md-1 pt-3">
      <h1>Book detail</h1>
      
      <table class="table table-white" >
        <tbody>         
          <tr>
            <td>
              <%=link_to user_path(@user.id) do %>                  
              <%=attachment_image_tag @user,:profile_image,:fill,50,50,format: 'jpeg', fallback: "no_image.jpg",size:"50x50"  %><br/>
                <%= @user.name %>
              <%end%>
            </td>
            <td><%=link_to @book.title,book_path(@book.id) %></td>
            <td><%=@book.body%></td>
    
            <% if @user==current_user %>
              <td><%= link_to "Edit",edit_book_path(@book.id),class:"btn btn-success btn-sm" %></td>
              <!--削除のアラートを-->
              <td><%= link_to "Destroy",book_path(@book.id),method: :delete,"data-confirm"=>"本当に消しますか？",class:"btn btn-danger btn-sm"%></td>
            <%end%>
    
            <!--いいねボタン-->
            <td><%= render"books/favorite",book:@book %></td>
            <!--コメント数カウント-->
            <td>コメント数<%= @book.book_comments.count %></td>
    
          </tr>
        </tbody>
      </table>
      
      <!--コメント内容-->
      <% @book.book_comments.each do |book_comment| %>
      <table class="pb-3">
        <tr>
          <td class= "pr-3">
            <%= attachment_image_tag book_comment.user,:profile_image,:fill,50,50,format: 'jpeg', fallback: "no_image.jpg",size:"50x50"%>
            <br/><%= link_to book_comment.user.name,user_path(book_comment.user.id) %>
          </td>
          <td><%= book_comment.comment %></td>
          <td><%= link_to "Destroy",book_book_comment_path(book_comment.book,book_comment),method: :delete,class:"btn btn-danger btn-sm"%></td>
        </tr>
      </table>
      <%end%>

      <!--コメントフォーム-->
      <%= form_with(model:[@book, @book_comment], local: true) do |f| %>
        <%= f.text_area :comment, rows:'5',placeholder: "", class:"form-control" %>
        <%= f.submit "送信する" %>
      <% end %>
      
    </div>
  </div>
</div>
                